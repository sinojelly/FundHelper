	<p>
	<button id="add-row">Add row</button>
	<div id="fund-table"></div> 
	<div id="updateModelStatus"></div>
	</p>
	<script>
	var tabledata = [
 	{id:"005911", name:"广发双擎升级混合", level:"5", price:"2.0368", change:"0.17", ratio_to_low:"-15.21", low_date:"20191021", ratio_to_high:"-1.02", high_date:"20191120"},
	{id:"320007", name:"诺安成长混合", level:"5", price:"1.195", change:"0.5", ratio_to_low:"-16.15", low_date:"20191021", ratio_to_high:"-3.77", high_date:"20191119"},
    ];
	var table = new Tabulator("#fund-table", {
 	height:205, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
 	data:tabledata, //assign data to table
 	layout:"fitColumns", //fit columns to width of table (optional)
	addRowPos:"bottom",
 	columns:[ //Define Table Columns
	    {title:"Fund ID", field:"id", editor:"input"},
	 	{title:"Name", field:"name", editor:"input"},
	 	{title:"Level", field:"level", editor:"input"},
		{title:"Price", field:"price"},
		{title:"Change", field:"change", sorter:"number"},
		{title:"R2Low", field:"ratio_to_low", sorter:"number"},
		{title:"LowDate", field:"low_date", sorter:"date",  editor:"input"},
	 	{title:"R2High", field:"ratio_to_high", sorter:"number"},
		{title:"HighDate", field:"high_date", sorter:"date",  editor:"input"},
		{title:"Trend", field:"trend"}
 	],
 	rowClick:function(e, row){ //trigger an alert message when the row is clicked
 		//alert("Row " + row.getData().id + " Clicked!!!!");
 	},
	dataEdited:function(data) {
	    var test=data;
	    //alert(data);
	},
    });
	
//Add row on "Add Row" button click
$("#add-row").click(function(){
    table.addRow({});
});

//Delete row on "Delete Row" button click
$("#del-row").click(function(){
    table.deleteRow(1);
});

//Clear table on "Empty the table" button click
$("#clear").click(function(){
    table.clearData()
});

//Reset table contents on "Reset the table" button click
$("#reset").click(function(){
    table.setData(tabledata);
});
	
	function append_parameter(url, name, value) {
	    if (!url.endsWith('?')) {
		    url = url + "&";
		}
	    return url + name + "=" + encodeURIComponent(value);
	}
	function update_model() {
		$("#updateModelStatus").text("Update model: Start...");
		var fund_id = $("#fund_id[name='fund_id']").val();
		var fund_level = $("#fund_level[name='fund_level']").val();
		var fund_high_date = $("#fund_high_date[name='fund_high_date']").val();
		var fund_low_date = $("#fund_low_date[name='fund_low_date']").val();
		var remove_fund_id = $("#remove_fund_id[name='remove_fund_id']").val();
		
		var url = 'update-model?';
		url = append_parameter(url, "fund_id", fund_id);
		url = append_parameter(url, "fund_level", fund_level);
		url = append_parameter(url, "fund_high_date", fund_high_date);
		url = append_parameter(url, "fund_low_date", fund_low_date);
		url = append_parameter(url, "remove_fund_id", remove_fund_id);
		
		$.get(url, function(data) {
			$("#updateModelStatus").text("Update model: " + data.msg);
		})
	}
	$(".updateModel").click(update_model);
	</script>
